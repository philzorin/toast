// This minimal build.gradle tricks JitPack into accepting pre-built AAR
plugins {
    id 'java' // Minimal plugin requirement
}

// Disable all tasks except what JitPack needs
tasks.whenTaskAdded { task ->
    if (task.name != 'publishToMavenLocal' && task.name != 'build') {
        task.enabled = false
    }
}

task build {
    doLast {
        // Copy your pre-built AAR to where JitPack expects it
        copy {
            from 'toast.aar'
            into "$buildDir/libs"
            rename 'toast.aar', "${project.name}-${version}.aar"
        }
        println "[JitPack] Using pre-built AAR - no compilation needed"
    }
}

task publishToMavenLocal {
    dependsOn build
    doLast {
        // Simulate Maven publish structure
        def mavenDir = "$buildDir/repo/com/github/philzorin/toast/$version"
        mkdir mavenDir
        copy {
            from "$buildDir/libs/toast-${version}.aar"
            into mavenDir
        }
        // Create minimal POM
        new File("$mavenDir/toast-${version}.pom") << """
<project>
  <modelVersion>4.0.0</modelVersion>
  <groupId>com.github.philzorin</groupId>
  <artifactId>toast</artifactId>
  <version>$version</version>
  <packaging>aar</packaging>
</project>
"""
    }
}
